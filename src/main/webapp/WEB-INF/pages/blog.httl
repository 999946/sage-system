<!DOCTYPE html>
<html>
<!--
#set(BlogView blog, List<TweetView> tweets)
#set(UserSelf userSelf)
-->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>${blog.title}</title>
	$!{allcss}
	<style type="text/css">
		#comments-container{
			margin-top: 20px;
			padding: 10px;
		}
	</style>
</head>
<body>
$!{include("navbar.httl")}
<div class="container" id="container">
	<div class="blog" data-id="$!{blog.id}">
		<h3 class="title">${blog.title}</h3>
		$!{userLabel(blog.author)}
		发表于 $!{spanHumanTime(blog.whenCreated)}
		#if(blog.whenModified)
		修改于 $!{spanHumanTime(blog.whenModified)}
		#end
		阅读数${blog.views}
		#if(userSelf.id == blog.author.id)
		<a href="/blogs/$!{blog.id}/edit"><span class="glyphicon glyphicon-edit">编辑</span></a>
		#end
		<div class="tags">
			#for(each : blog.tags)
				$!{tagLabel(each)}
			#end
		</div>
		<div id="loading-alert" class="alert alert-info" role="alert">Markdown正在加载...</div>
		<div class="content">$!{blog.content}</div>
		<div>
			$!{include("btn_like.httl", ["likes": blog.likes, "isLiked": isLiked, "prefix": "/blogs/"+blog.id.toString])}
		</div>
	</div>
	<div id="comments-container" data-tweetid="${blog.tweetId}" class="background-silver"></div>
</div>
$!{alljs}
<script type="text/javascript">
	setup(humanTime_setup, tag_setup, user_setup)
	$(document).ready(function() {
		$('.content').warnEmpty().each(function(){
			var $this = $(this)
			$this.html(marked($this.text()))
		});
		$('#loading-alert').hide()
		btnLike_init()

		var id = $('.blog').data('id')
		comments_render('#comments-container', 2, $('#comments-container').data('tweetid'))
	})
</script>
</body>
</html>
